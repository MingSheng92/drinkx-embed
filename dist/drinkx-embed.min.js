(()=>{(function(p,d){"use strict";function m(c,e){let t;return function(...i){let s=()=>{clearTimeout(t),c(...i)};clearTimeout(t),t=setTimeout(s,e)}}function u(c,e="",t=""){let n=d.createElement(c);return e&&(n.className=e),t&&(n.innerHTML=t),n}function o(c){let e=d.createElement("div");return e.textContent=c,e.innerHTML}class g{constructor(e,t={}){this.containerId=e,this.container=d.getElementById(e),this.options={venueId:t.venueId,apiUrl:t.apiUrl||"https://business.untappd.com/api",theme:t.theme||"light",showSearch:t.showSearch!==!1,showRatings:t.showRatings!==!1,showPrices:t.showPrices!==!1,...t},this.menuData=null,this.originalMenuData=null,this.searchQuery="",this.isSearchActive=!1,this.currentDisplayMenu=null,this.init()}async init(){if(!this.container){console.error(`Container with ID "${this.containerId}" not found`);return}this.injectStyles(),this.render(),await this.loadMenuData()}injectStyles(){let e=`menu-embed-styles-${this.containerId}`;if(d.getElementById(e))return;let n=u("style","",`
                .menu-embed-container {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    line-height: 1.5;
                    color: #333;
                }
                
                .menu-embed-section {
                    margin-bottom: 8px;
                }
                
                .menu-embed-section-header {
                    background-color: #f0b258;
                    padding: 8px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                    user-select: none;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }
                
                .menu-embed-section-title {
                    margin: 0;
                    font-weight: 600;
                    color: #2c3e50;
                    font-size: 1rem;
                }
                
                .menu-embed-chevron {
                    transition: transform 0.3s ease;
                    font-size: 12px;
                }
                
                .menu-embed-chevron.expanded {
                    transform: rotate(180deg);
                }
                
                .menu-embed-section-content {
                    background: white;
                    border: 1px solid #ddd;
                    border-top: none;
                    border-radius: 0 0 4px 4px;
                    padding: 12px;
                    overflow: hidden;
                    transition: all 0.3s ease;
                }
                
                .menu-embed-section-content.collapsed {
                    max-height: 0;
                    padding: 0 12px;
                    opacity: 0;
                }
                
                .menu-embed-item {
                    display: flex;
                    align-items: flex-start;
                    margin-bottom: 16px;
                    padding: 12px;
                    background: #fff;
                    border: 1px solid #e9ecef;
                    border-radius: 8px;
                    transition: all 0.2s ease;
                }
                
                .menu-embed-item:hover {
                    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
                    transform: translateY(-1px);
                }
                
                .menu-embed-item-image {
                    width: 80px;
                    height: 80px;
                    background-color: #f8f6f0;
                    border-radius: 8px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 12px;
                    flex-shrink: 0;
                }
                
                .menu-embed-item-image img {
                    max-width: 70px;
                    max-height: 70px;
                    object-fit: contain;
                    border-radius: 4px;
                }
                
                .menu-embed-item-content {
                    flex: 1;
                    min-width: 0;
                }
                
                .menu-embed-item-title {
                    margin: 0 0 4px 0;
                    font-weight: 600;
                    color: #2c3e50;
                    font-size: 1rem;
                    text-decoration: underline;
                }
                
                .menu-embed-item-meta {
                    font-size: 0.875rem;
                    color: #6c757d;
                    margin-bottom: 8px;
                }
                
                .menu-embed-item-description {
                    font-size: 0.875rem;
                    color: #6c757d;
                    margin-bottom: 8px;
                }
                
                .menu-embed-item-price {
                    font-weight: 500;
                    color: #2c3e50;
                    margin-bottom: 4px;
                }
                
                .menu-embed-unavailable {
                    color: #dc3545;
                    font-weight: bold;
                    font-style: italic;
                    text-decoration: underline;
                    font-size: 0.875rem;
                }
                
                .menu-embed-rating {
                    display: flex;
                    align-items: center;
                    font-weight: bold;
                    margin-left: auto;
                }
                
                .menu-embed-star {
                    color: #ffc107;
                    margin-left: 4px;
                }
                
                .menu-embed-search {
                    width: 100%;
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    margin-bottom: 16px;
                    font-size: 1rem;
                }
                
                .menu-embed-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 16px;
                }
                
                .menu-embed-section-count {
                    font-weight: bold;
                    font-size: 1.1rem;
                    margin: 0;
                }
                
                .menu-embed-loading {
                    text-align: center;
                    padding: 20px;
                    color: #6c757d;
                }
                
                .menu-embed-empty {
                    text-align: center;
                    padding: 20px;
                    color: #6c757d;
                }
                
                .menu-embed-pagination {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    gap: 8px;
                    margin-top: 16px;
                    padding: 8px;
                    background-color: #f8f9fa;
                    border-radius: 4px;
                }
                
                .menu-embed-pagination button {
                    padding: 4px 8px;
                    border: 1px solid #ccc;
                    background: white;
                    border-radius: 4px;
                    cursor: pointer;
                }
                
                .menu-embed-pagination button:disabled {
                    opacity: 0.5;
                    cursor: not-allowed;
                }
                
                /* Mobile responsive */
                @media (max-width: 576px) {
                    .menu-embed-item-image {
                        width: 60px;
                        height: 60px;
                    }
                    
                    .menu-embed-item-image img {
                        max-width: 50px;
                        max-height: 50px;
                    }
                    
                    .menu-embed-item-title {
                        font-size: 0.9rem;
                    }
                    
                    .menu-embed-item-meta {
                        font-size: 0.8rem;
                    }
                }
            `);n.id=e,d.head.appendChild(n)}render(){this.container.innerHTML=`
                <div class="menu-embed-container">
                    <div class="menu-embed-loading">Loading menu...</div>
                </div>
            `}async loadMenuData(){try{let t=await(await fetch(`${this.options.apiUrl}/menu/${this.options.venueId}`)).json(),n=t.filter(i=>!i.isSubSection).map(i=>({...i,isExpanded:!1,subSections:t.filter(s=>s.isSubSection&&s.parentSectionId===i.id).map(({id:s,sectionName:a,sectionOrder:r})=>({id:s,sectionName:a,sectionOrder:r,isExpanded:!1,sectionMenu:[],isLoading:!1}))}));this.menuData={menu:n},this.originalMenuData=JSON.parse(JSON.stringify(this.menuData)),this.currentDisplayMenu=this.menuData,this.renderMenu()}catch(e){console.error("Failed to load menu data:",e),this.container.innerHTML=`
                    <div class="menu-embed-container">
                        <div class="menu-embed-empty">Failed to load menu. Please try again later.</div>
                    </div>
                `}}renderMenu(){let e=this.currentDisplayMenu,t=e.menu&&e.menu.length||0,n=`
                <div class="menu-embed-container">
                    <div class="menu-embed-header">
                        <p class="menu-embed-section-count">${o(t)} Sections On The Menu</p>
                    </div>
            `;this.options.showSearch&&(n+=`
                    <input type="text" class="menu-embed-search" placeholder="Search menu..." value="${o(this.searchQuery)}">
                `),e.menu&&e.menu.length>0?(n+='<div class="menu-embed-sections">',e.menu.forEach((i,s)=>{n+=this.renderSection(i,s)}),n+="</div>"):n+=`<div class="menu-embed-empty">This venue hasn't added any drinks to their menu yet.</div>`,n+="</div>",this.container.innerHTML=n,this.bindEvents()}renderSection(e,t){let n=e.isExpanded,i=n?"expanded":"",s=`
                <div class="menu-embed-section" data-section-index="${t}">
                    <div class="menu-embed-section-header" data-section-toggle="${t}">
                        <h6 class="menu-embed-section-title">${o(e.sectionName)}</h6>
                        <span class="menu-embed-chevron ${i}">\u25BC</span>
                    </div>
                    <div class="menu-embed-section-content ${n?"":"collapsed"}" data-section-content="${t}">
            `;return e.isLoading?s+='<div class="menu-embed-loading">Loading...</div>':(e.subSections&&e.subSections.length>0&&e.subSections.forEach(a=>{s+=this.renderSubSection(a)}),e.sectionMenu&&e.sectionMenu.length>0&&(e.sectionMenu.forEach(a=>{s+=this.renderMenuItem(a)}),e.pagination&&e.pagination.total_pages>1&&(s+=this.renderPagination(e.pagination,t))),(!e.subSections||e.subSections.length===0)&&(!e.sectionMenu||e.sectionMenu.length===0)&&(s+='<div class="menu-embed-empty">No items in this section.</div>')),s+="</div></div>",s}renderSubSection(e){let t=e.isExpanded,n=t?"expanded":"",i=`
                <div class="menu-embed-section" data-subsection-id="${e.id}">
                    <div class="menu-embed-section-header" data-subsection-toggle="${e.id}">
                        <h6 class="menu-embed-section-title">${o(e.sectionName)}</h6>
                        <span class="menu-embed-chevron ${n}">\u25BC</span>
                    </div>
                    <div class="menu-embed-section-content ${t?"":"collapsed"}">
            `;return e.isLoading?i+='<div class="menu-embed-loading">Loading...</div>':e.sectionMenu&&e.sectionMenu.length>0?e.sectionMenu.forEach(s=>{i+=this.renderMenuItem(s)}):i+='<div class="menu-embed-empty">No items in this sub-section.</div>',i+="</div></div>",i}renderMenuItem(e){let t=e.itemAvailability===!1?"grayscale(100%)":"none",n=e.photo&&e.photo.trim()!==""?`<img src="${o(e.photo)}" alt="${o(e.name)}" style="filter: ${t};">`:'<span style="font-size: 28px; color: #d4941e;">\u{1F37A}</span>',i=this.options.showRatings?e.averageRating==0?'<span class="menu-embed-star">\u2606</span>':`<div class="menu-embed-rating"><b>${o(e.averageRating)}</b><span class="menu-embed-star">\u2605</span></div>`:"",s=this.options.showPrices?`<p class="menu-embed-item-price">${e.itemPrice<=0?"-":`$ ${o(e.itemPrice)} / ${o(e.servingTypeText)||"serving"}`}</p>`:"",a=e.itemAvailability===!1?'<p class="menu-embed-unavailable">Temporarily Unavailable</p>':"";return`
                <div class="menu-embed-item" data-item-id="${e.itemID}">
                    <div class="menu-embed-item-image">
                        ${n}
                    </div>
                    <div class="menu-embed-item-content">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 4px;">
                            <h5 class="menu-embed-item-title">${o(e.name)}${e.variant?` [${o(e.variant)} Vintage]`:""}</h5>
                            ${i}
                        </div>
                        <p class="menu-embed-item-meta">${o(e.bottler)||"Unknown Producer"} | ${o(e.drinkType)||"N/A type"} | ${e.abv?o(e.abv)+"%":"N/A ABV"}</p>
                        <p class="menu-embed-item-description">${o(e.description)||""}</p>
                        ${s}
                        ${a}
                    </div>
                </div>
            `}renderPagination(e,t){return`
                <div class="menu-embed-pagination" data-section-pagination="${t}">
                    <button ${e.page<=1?"disabled":""} data-page="${e.page-1}">Previous</button>
                    <span>Page ${o(e.page)} of ${o(e.total_pages)}</span>
                    <button ${e.page>=e.total_pages?"disabled":""} data-page="${e.page+1}">Next</button>
                </div>
            `}bindEvents(){if(this.options.showSearch){let e=this.container.querySelector(".menu-embed-search");if(e){let t=m(n=>this.handleSearch(n.target.value),500);e.addEventListener("input",t)}}this.container.addEventListener("click",e=>{if(e.target.closest("[data-section-toggle]")){let t=e.target.closest("[data-section-toggle]").dataset.sectionToggle;this.toggleSection(parseInt(t))}if(e.target.closest("[data-subsection-toggle]")){let t=e.target.closest("[data-subsection-toggle]").dataset.subsectionToggle;this.toggleSubSection(t)}if(e.target.closest("[data-section-pagination] button")){let t=e.target.closest("button"),n=e.target.closest("[data-section-pagination]").dataset.sectionPagination,i=parseInt(t.dataset.page);t.disabled||this.loadSectionMenu(parseInt(n),i)}if(e.target.closest("[data-item-id]")){let t=e.target.closest("[data-item-id]").dataset.itemId;this.options.onItemClick&&this.options.onItemClick(t)}})}async toggleSection(e){let t=this.currentDisplayMenu.menu[e];t.isExpanded=!t.isExpanded,t.isExpanded&&this.searchQuery.trim()===""&&(!t.sectionMenu||t.sectionMenu.length===0)&&await this.loadSectionMenu(e),this.updateSectionDisplay(e)}async toggleSubSection(e){let t=null;this.currentDisplayMenu.menu.forEach(n=>{n.subSections&&n.subSections.forEach(i=>{i.id==e&&(t=i)})}),t&&(t.isExpanded=!t.isExpanded,t.isExpanded&&this.searchQuery.trim()===""&&(!t.sectionMenu||t.sectionMenu.length===0)&&await this.loadSectionMenu(null,1,t),this.renderMenu())}updateSectionDisplay(e){let t=this.container.querySelector(`[data-section-content="${e}"]`),n=this.container.querySelector(`[data-section-toggle="${e}"] .menu-embed-chevron`),i=this.currentDisplayMenu.menu[e];t&&n&&(i.isExpanded?(t.classList.remove("collapsed"),n.classList.add("expanded")):(t.classList.add("collapsed"),n.classList.remove("expanded")))}async loadSectionMenu(e,t=1,n=null){let i=n||this.currentDisplayMenu.menu[e],s=i.id;if(!i.isLoading)try{i.isLoading=!0,this.renderMenu();let a=await fetch(`${this.options.apiUrl}/getData/getVenueMenu/${s}?page=${t}&limit=30`);if(!a.ok)throw new Error(`HTTP ${a.status}`);let r=await a.json(),l=r.data||[],h=r.pagination||{page:t,limit:30,total_pages:1};i.sectionMenu=l,i.pagination=h,i.itemCount=h.total_items||l.length}catch(a){console.error(`Error loading menu section ${s}:`,a),i.hasError=!0,i.sectionMenu=[]}finally{i.isLoading=!1,this.renderMenu()}}async handleSearch(e){if(this.searchQuery=e,e.trim()===""){this.isSearchActive=!1,this.currentDisplayMenu=this.originalMenuData,this.renderMenu();return}try{let t=await fetch(`${this.options.apiUrl}/getData/getVenueMenuBySearch/${this.options.venueId}?searchTerm=${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`HTTP ${t.status}`);let n=await t.json(),i=JSON.parse(JSON.stringify(this.originalMenuData));i.menu.forEach(s=>{s.sectionMenu=[],s.isExpanded=!1,s.subSections&&s.subSections.forEach(a=>{a.sectionMenu=[],a.isExpanded=!1})}),n.menu&&this.populateSearchResults(i,n),this.currentDisplayMenu=i,this.isSearchActive=!0,this.renderMenu()}catch(t){console.error("Search failed:",t)}}populateSearchResults(e,t){t.menu.forEach(n=>{let i=e.menu.find(s=>s.id===n.id||s.sectionName===n.sectionName);if(i){i.sectionMenu=n.sectionMenu||[];let s=i.sectionMenu.length>0;n.subSections&&i.subSections&&n.subSections.forEach(a=>{let r=i.subSections.find(l=>l.id===a.id||l.sectionName===a.sectionName);r&&(r.sectionMenu=a.sectionMenu||[],r.isExpanded=r.sectionMenu.length>0,r.isExpanded&&(s=!0))}),i.isExpanded=s}})}refresh(){this.loadMenuData()}updateOptions(e){this.options={...this.options,...e},this.renderMenu()}}p.MenuEmbed={create:function(c,e){return new g(c,e)}}})(window,document);document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[data-menu-embed]").forEach(d=>{let m=d.dataset.venueId,u=d.dataset.apiUrl,o=d.dataset.theme;m&&window.MenuEmbed.create(d.id,{venueId:m,apiUrl:u,theme:o})})});})();
